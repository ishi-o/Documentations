# 重采样方法

## 简介

- 此前我们所说的`RSE`、置信区间等指标都需要测试误差，而测试误差是不可知的，因为没有标签
- 因此需要用一定的方法**估计**测试误差
- 在真正处于没有标签的环境之前，可以通过切出小部分数据集不让模型训练，从而预估模型的效果，分割出来给模型训练的是训练集，其余的为测试集，有时希望人工调整一些参数，会继续分割为验证集和测试集，验证集用于中期人工调整、测试集用于最终效果评估和展示(不再调整)
- 验证集的思路是好的，但是验证集通常是远小于训练集的数据量，且具有偶然性，测试误差被高估(有偏的)(不同的分割方式对误差影响大)

## 交叉验证法

### `K`折交叉验证

- `K`折交叉验证就是用于估计测试误差的被广泛使用的方法
- 其原理是将数据集分为`K`折大小一致的组，进行`K`次训练-测试，其中第`i`次的测试集为第`i`组，其余组为训练集，交叉验证最终的`MSE`为`K`次测试`MSE`的均值
- 通过划分来进行交叉验证，解决了验证集方法因训练次数只有一次而因划分方案导致的随机性，`K`折交叉验证本身也会因`K`的变大而变得更加稳定
- 当`K`不那么小时，可将交叉验证估计出来的误差为对某$\frac nk$个未知样本的误差的渐进无偏估计，当`K`变大其训练集的样本数自然变少，从而和验证集方法一样变得有偏

### 留一法

- `LOOCV`(留一法)是特殊的`K`折交叉验证，它把数据集分为`n`(样本数)组，即验证集只有一个样本，因此会进行完整`n`次训练-测试拟合
- `LOOCV`是对某一个未知样本的误差的渐进无偏估计，渐进指`N`十分大时，估计出的误差和真实的泛化误差差不多
  
  由于留一法测试时选取的是一个样本，所以说是对某**一个**未知样本的无偏估计，又因为训练集几乎等同于整个数据集，留一法的偏差会更小
- 留一法的划分是固定的，因为每一折只有一个样本，划分方案只有一种，对同一个数据集，留一法的估计结果是确定的
- 在采用最小二乘法拟合线性模型时，`LOOCV`估计的误差可以近似于只进行一次拟合：

  $$
  CV_(n)=\frac1n\sum_{i=1}^n\left(\frac{y_i-\hat y_i}{1-h_i}\right)
  $$

## 自助法

- 自助法专注于估计一个统计量的**不确定性**，比如泛化误差的标准差和置信区间，而不是估计泛化误差
- 估计不确定性需要大量的数据和大量的重复试验来估计统计量的总体分布，因此交叉验证不适合
- 自助法的原理是对数据集进行多次**有放回重复简单随机抽样**，从而获得近似总体的若干数据集，一次简单随机抽样获得的数据集和原始数据集大小一致，称为一个自助样本
  
  然后，对于每个自助样本，可以证明**当`n`较大**时有大概**三分之二的重复**的样本点，自助法使用自助样本来训练，使用袋外样本来测试，得到对应的统计量，这个**统计量(例如泛化误差)一般是被低估**的，虽然测试集和训练集没有重叠，但是训练集本身因为有重复样本已经和总体分布偏离了

  虽然统计量的偏差较大，但是其方差、置信区间等却能很好地代表总体的方差
- 三分之二重复的证明：抽样符合$P(x未被抽中)=\left(1-\frac{1}{n}\right)^n$，`n`取极大后取极限为$\frac1e$约等于三分之一
- 蒙特卡洛模拟对该方法进行了压力测试，即使统计量的估计分布和其总体分布偏差较大，但统计量的估计分布的不确定性却十分准确
