### 树堆

- 树堆本体是一棵**二叉搜索树**，只不过在维护时，需要**针对某个指标维护成堆**，以达到一种弱平衡的性质
  这里的弱平衡，指的是**期望平衡**，而不是像`AVL`树那样的严格保证左右子树高度差不超过$1$
  我们记树的值为键，堆的值为优先级(或值)；结论：在优先级是随机给出的情况，树堆可以达到弱平衡
- 首先，朴素的二叉搜索树对插入顺序十分敏感，如果**插入序列是单调**的，整棵树就**退化为链表**了
  而通过**随机生成优先级**对原序列进行标记，再根据优先级排序，就可以打乱原先的插入顺序再按朴素`BST`的方法建树，避免上述的退化
  但通常不这样建树(虽然是可行的)，而是插入过程中**针对优先级维护成堆**，这也就是`Treap`的来源
  顺带一提，在后面可以看到，如果键本身自然有序，就能$O(n)$建树(这是不同于上述两种方法的第三种方法)，这在**笛卡尔树**中有所体现